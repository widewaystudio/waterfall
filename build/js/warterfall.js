function minH(e){for(var t=e[0],n=1,o=0;n<e.length;n++)t>e[n]&&(t=e[n],o=n);return o}function getScroll(){return window.pageXoffset?{x:window.pageXoffset,y:window.pageYoffset}:{x:document.body.scrollLeft+document.documentElement.scrollLeft,y:document.body.scrollTop+document.documentElement.scrollTop}}function choke(n,o){var l=0;return function(){var e=arguments,t=Date.now();o<t-l&&(n.apply(this,e),l=t)}}!function(){var a=[],t=1,p=!1;function n(e,t,n,o,l){var i=null;e=e.toUpperCase();i=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHttp"),"GET"==e?(i.open(e,t+"?"+n,l),i.send()):"POST"==e&&(i.open(e,t,!0),i.setRequestHeader("Content-type","application/x-www-form-urlencoded"),i.send(n)),i.onreadystatechange=function(){4==i.readyState&&200==i.status&&o(i.responseText)}}function o(e){var o,t=JSON.parse(e),l="",i=0,c=document.getElementsByClassName("wrapper")[0];if(0<t.length)t.forEach(function(e,t){var n=document.createElement("div");n.className="box",i=Math.ceil(228*e.height/e.width),l='<a href="'+e.url+'" alt ="'+e.title+'" style="height:'+i+'px">\t\t\t\t        <img src ="'+e.preview+'" height ="'+i+'"  width="228" alt="'+e.title+'">\t\t\t\t        </a>',l+=0==e.title.length?"":"<p>"+e.title+"</p>",t<4&&4!=a.length?(n.style.left=260*t+"px",n.style.top="0px",n.innerHTML=l,c.appendChild(n),a.push(n.offsetHeight)):(o=minH(a),n.style.left=260*o+"px",n.style.top=a[o]+10+"px",n.innerHTML=l,c.appendChild(n),a[o]+=n.offsetHeight+10)}),p=!1;else{var n=document.createElement("div");n.innerHTML="没有更多的内容展示了，亲！",n.className="bot",document.body.appendChild(n)}}n("get","getPics.php","cpage=1",o,!0),window.onscroll=choke(function(){var e=getScroll();pageH=parseInt(a[minH(a)]),MaxH=document.documentElement.clientHeight||document.body.clientHeight,pageH<=MaxH+e.y&&(p||n("get","getPics.php","cpage="+ ++t,o,p=!0))},100)}();